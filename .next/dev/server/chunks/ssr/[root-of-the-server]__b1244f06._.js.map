{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///Users/kaushikieee/Downloads/code/lib/googleSheetsAuth.ts"],"sourcesContent":["import { google } from 'googleapis';\n\n/**\n * Authenticated Google Sheets API client using service account credentials\n * This allows reading from private sheets that the service account has access to\n */\n\ninterface ServiceAccountCredentials {\n  type: 'service_account';\n  project_id: string;\n  private_key_id: string;\n  private_key: string;\n  client_email: string;\n  client_id: string;\n  auth_uri: string;\n  token_uri: string;\n  auth_provider_x509_cert_url: string;\n  client_x509_cert_url: string;\n  universe_domain: string;\n}\n\n/**\n * Get authenticated Google Sheets client\n */\nfunction getAuthenticatedSheets() {\n  const privateKey = process.env.GOOGLE_SHEETS_PRIVATE_KEY?.replace(/\\\\n/g, '\\n');\n  const clientEmail = process.env.GOOGLE_SHEETS_CLIENT_EMAIL;\n\n  if (!privateKey || !clientEmail) {\n    console.warn('Google Sheets authentication credentials not configured');\n    return null;\n  }\n\n  try {\n    const auth = new google.auth.GoogleAuth({\n      credentials: {\n        type: 'service_account',\n        private_key: privateKey,\n        client_email: clientEmail,\n      } as any,\n      scopes: ['https://www.googleapis.com/auth/spreadsheets.readonly'],\n    });\n\n    return google.sheets({ version: 'v4', auth });\n  } catch (error) {\n    console.error('Failed to authenticate with Google Sheets:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch data from a specific sheet range\n */\nexport async function getSheetData(spreadsheetId: string, range: string) {\n  const sheets = getAuthenticatedSheets();\n  if (!sheets) {\n    throw new Error('Google Sheets client not initialized');\n  }\n\n  try {\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range,\n    });\n\n    return response.data.values || [];\n  } catch (error) {\n    console.error(`Failed to fetch sheet data from ${range}:`, error);\n    throw error;\n  }\n}\n\n/**\n * Convert sheet rows to objects using headers\n */\nexport function rowsToObjects(rows: any[][]): Record<string, any>[] {\n  if (rows.length < 2) return [];\n\n  const [headers, ...dataRows] = rows;\n  return dataRows.map(row => {\n    const obj: Record<string, any> = {};\n    headers.forEach((header, index) => {\n      obj[header] = row[index] || '';\n    });\n    return obj;\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAqBA;;CAEC,GACD,SAAS;IACP,MAAM,aAAa,QAAQ,GAAG,CAAC,yBAAyB,EAAE,QAAQ,QAAQ;IAC1E,MAAM,cAAc,QAAQ,GAAG,CAAC,0BAA0B;IAE1D,IAAI,CAAC,cAAc,CAAC,aAAa;QAC/B,QAAQ,IAAI,CAAC;QACb,OAAO;IACT;IAEA,IAAI;QACF,MAAM,OAAO,IAAI,2OAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACtC,aAAa;gBACX,MAAM;gBACN,aAAa;gBACb,cAAc;YAChB;YACA,QAAQ;gBAAC;aAAwD;QACnE;QAEA,OAAO,2OAAM,CAAC,MAAM,CAAC;YAAE,SAAS;YAAM;QAAK;IAC7C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8CAA8C;QAC5D,OAAO;IACT;AACF;AAKO,eAAe,aAAa,aAAqB,EAAE,KAAa;IACrE,MAAM,SAAS;IACf,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC;YACpD;YACA;QACF;QAEA,OAAO,SAAS,IAAI,CAAC,MAAM,IAAI,EAAE;IACnC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,gCAAgC,EAAE,MAAM,CAAC,CAAC,EAAE;QAC3D,MAAM;IACR;AACF;AAKO,SAAS,cAAc,IAAa;IACzC,IAAI,KAAK,MAAM,GAAG,GAAG,OAAO,EAAE;IAE9B,MAAM,CAAC,SAAS,GAAG,SAAS,GAAG;IAC/B,OAAO,SAAS,GAAG,CAAC,CAAA;QAClB,MAAM,MAA2B,CAAC;QAClC,QAAQ,OAAO,CAAC,CAAC,QAAQ;YACvB,GAAG,CAAC,OAAO,GAAG,GAAG,CAAC,MAAM,IAAI;QAC9B;QACA,OAAO;IACT;AACF"}}]
}