(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77735,e=>{"use strict";var t=e.i(45471);let a=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:l=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:n,iconNode:d,...c},m)=>(0,t.createElement)("svg",{ref:m,...r,width:l,height:l,stroke:e,strokeWidth:i?24*Number(s)/Number(l):s,className:a("lucide",o),...c},[...d.map(([e,a])=>(0,t.createElement)(e,a)),...Array.isArray(n)?n:[n]])),s=(e,r)=>{let s=(0,t.forwardRef)(({className:s,...i},o)=>(0,t.createElement)(l,{ref:o,iconNode:r,className:a(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,s),...i}));return s.displayName=`${e}`,s};e.s(["default",()=>s],77735)},52964,e=>{"use strict";let t=(0,e.i(77735).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],52964)},28438,e=>{"use strict";var t=e.i(122),a=e.i(45471),r=e.i(17591),l=e.i(77735);let s=(0,l.default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),i=(0,l.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var o=e.i(52964);function n(){let e=(0,r.useRouter)(),[l,n]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[m,u]=(0,a.useState)(""),[p,g]=(0,a.useState)(!1),[x,h]=(0,a.useState)(!1),[y,f]=(0,a.useState)(null),[v,b]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=localStorage.getItem("admin-lockout");if(e){let t=parseInt(e);Date.now()<t?(h(!0),f(t)):(localStorage.removeItem("admin-lockout"),localStorage.removeItem("admin-attempts"))}},[]),(0,a.useEffect)(()=>{if(!x||!y)return;let e=setInterval(()=>{let t=y-Date.now();t<=0?(h(!1),f(null),localStorage.removeItem("admin-lockout"),localStorage.removeItem("admin-attempts"),clearInterval(e)):b(Math.ceil(t/1e3))},1e3);return()=>clearInterval(e)},[x,y]);let w=async t=>{if(t.preventDefault(),x)return void u(`Account temporarily locked. Try again in ${v} seconds.`);if(u(""),g(!0),!l||!d){u("Email and password are required"),g(!1);return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)){u("Please enter a valid email address"),g(!1);return}if(d.length<6){u("Invalid email or password"),g(!1);return}try{let t=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,password:d})});if(t.ok){let a=await t.json();localStorage.removeItem("admin-attempts"),localStorage.removeItem("admin-lockout"),localStorage.setItem("admin-auth",a.token),localStorage.setItem("admin-auth-expires",a.expiresAt),e.push("/admin/dashboard")}else{let e=await t.json();if(429===t.status){u("Too many login attempts. Account locked for 15 minutes."),h(!0);let e=Date.now()+9e5;f(e),localStorage.setItem("admin-lockout",e.toString()),localStorage.removeItem("admin-attempts")}else{let t=parseInt(localStorage.getItem("admin-attempts")||"0")+1;if(localStorage.setItem("admin-attempts",t.toString()),t>=5){u("Too many failed attempts. Account locked for 15 minutes."),h(!0);let e=Date.now()+9e5;f(e),localStorage.setItem("admin-lockout",e.toString())}else u(e.message||"Invalid email or password")}}}catch(e){console.error("Login error:",e),u("An error occurred. Please try again.")}finally{g(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold mb-2",style:{color:"var(--peep-primary)"},children:"PEEP"}),(0,t.jsx)("p",{className:"text-gray-600 font-medium",children:"Admin Portal"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Public Environmental Evidence Platform"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 p-8",children:[(0,t.jsxs)("form",{onSubmit:w,className:"space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Address"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(i,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,t.jsx)("input",{type:"email",value:l,onChange:e=>n(e.target.value),placeholder:"admin@peep.com",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-1",style:{"--tw-ring-color":"var(--peep-primary)"},required:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(s,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,t.jsx)("input",{type:"password",value:d,onChange:e=>c(e.target.value),placeholder:"••••••••",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-1",style:{"--tw-ring-color":"var(--peep-primary)"},required:!0})]})]}),m&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 flex gap-2",children:[(0,t.jsx)(o.AlertCircle,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,t.jsx)("p",{className:"text-sm text-red-800",children:m})]}),(0,t.jsx)("button",{type:"submit",disabled:p||x,className:"w-full py-2 px-4 rounded-lg font-semibold text-white transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--peep-primary)"},children:x?`Locked (${v}s)`:p?"Logging in...":"Login"})]}),(0,t.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,t.jsx)("p",{className:"text-xs text-blue-900 font-medium",children:"Security Features Enabled"}),(0,t.jsxs)("ul",{className:"text-xs text-blue-800 mt-2 space-y-1",children:[(0,t.jsx)("li",{children:"✓ Server-side authentication"}),(0,t.jsx)("li",{children:"✓ Rate limiting (5 attempts / 15 mins)"}),(0,t.jsx)("li",{children:"✓ Session tokens with expiration"}),(0,t.jsx)("li",{children:"✓ Input validation & sanitization"})]})]})})]}),(0,t.jsxs)("div",{className:"text-center mt-6 space-y-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Authorized personnel only"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Demo: admin@peep.com / admin123"})]})]})})}e.s(["default",()=>n],28438)}]);