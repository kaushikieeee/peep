(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,60289,e=>{"use strict";let t=(0,e.i(77735).default)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);e.s(["Share2",()=>t],60289)},52964,e=>{"use strict";let t=(0,e.i(77735).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],52964)},9633,24791,87654,e=>{"use strict";var t=e.i(77735);let a=(0,t.default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);e.s(["ChevronUp",()=>a],9633);let l=(0,t.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function s(e,t){if(!e.trim())return t;let a=e.toLowerCase();return t.filter(e=>e.name.toLowerCase().includes(a)).sort((e,t)=>e.name.toLowerCase().indexOf(a)-t.name.toLowerCase().indexOf(a)).slice(0,5)}e.s(["Check",()=>l],24791),e.s(["fuzzySearch",()=>s],87654)},43346,e=>{"use strict";var t=e.i(122),a=e.i(45471),l=e.i(52964),s=e.i(9633),r=e.i(24791),i=e.i(60289),o=e.i(60060),n=e.i(69257),d=e.i(20403),c=e.i(87654);let x=[{name:"School Gate",lat:12.9716,lng:77.5946,zone:"Zone P1"},{name:"Park North",lat:12.974,lng:77.5955,zone:"Zone W2"},{name:"Sports Field",lat:12.9705,lng:77.5935,zone:"Zone P2"},{name:"Drainage Area",lat:12.9719,lng:77.595,zone:"Zone P1"},{name:"Construction Site",lat:12.9715,lng:77.5965,zone:"Zone C3"},{name:"Residential Corner",lat:12.971,lng:77.592,zone:"Zone W3"},{name:"Industrial Zone",lat:12.9745,lng:77.5945,zone:"Zone S1"},{name:"Local Market",lat:12.9695,lng:77.5955,zone:"Zone P3"},{name:"Park South",lat:12.9735,lng:77.593,zone:"Zone O1"},{name:"Walking Trail",lat:12.9725,lng:77.5938,zone:"Zone C2"}];function m(){let[e,m]=(0,a.useState)([]),[h,u]=(0,a.useState)(x),[p,g]=(0,a.useState)(null),[y,b]=(0,a.useState)(null),[f,j]=(0,a.useState)(null),[v,N]=(0,a.useState)(!1),[w,C]=(0,a.useState)("location"),[k,S]=(0,a.useState)(!1),[P,L]=(0,a.useState)(null),[z,M]=(0,a.useState)(""),[R,A]=(0,a.useState)([]),[T,Z]=(0,a.useState)(""),[E,U]=(0,a.useState)(""),[B,D]=(0,a.useState)(""),[F,O]=(0,a.useState)("Medium"),[H,W]=(0,a.useState)(null),[q,I]=(0,a.useState)(!0),[$,G]=(0,a.useState)([]),[K,V]=(0,a.useState)(""),[J,Q]=(0,a.useState)(!0),[X,Y]=(0,a.useState)(null);(0,a.useEffect)(()=>{console.log("[MapPage] Fetching reports from API..."),fetch("/api/data/reports").then(e=>e.json()).then(e=>{console.log("[MapPage] Loaded reports:",e.length),m(e)}).catch(e=>console.error("[MapPage] Failed to load data:",e))},[]),(0,a.useEffect)(()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(e=>{let t={lat:e.coords.latitude,lng:e.coords.longitude};g(t),L({...t,label:"Current Location"})},e=>{b("Can't access your location. Type a place name or drag the pin.")})},[]),(0,a.useEffect)(()=>{z.trim()?A((0,c.fuzzySearch)(z,h)):A([])},[z,h]);let _=null!==P,ee=T.trim().length>=5&&E.trim().length>0&&B&&null!==H;return(0,t.jsxs)("div",{className:"fixed top-0 left-0 right-0 bottom-0 bg-white flex flex-col",children:[(0,t.jsx)("div",{className:"z-30 bg-white border-b border-gray-200 px-4 py-3 flex-shrink-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-xl font-bold text-balance",style:{color:"var(--peep-primary)"},children:[(0,t.jsx)("span",{className:"sr-only",children:"PEEP - "}),"Pollution Map"]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"View reports near you • No reports nearby? Be the first to PEEP!"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:()=>S(!k),className:"p-2 hover:bg-gray-100 rounded-lg transition-all","aria-label":"Profile menu",children:(0,t.jsx)(o.User,{className:"w-6 h-6 text-gray-700"})}),k&&(0,t.jsxs)("div",{className:"absolute right-0 mt-1 bg-white rounded-lg border border-gray-200 shadow-lg p-3 min-w-max z-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,t.jsx)(o.User,{className:"w-6 h-6 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:"Pragadeesh"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"Local Reporter"})]})]}),(0,t.jsx)("hr",{className:"my-2"}),(0,t.jsx)(n.default,{href:"/peep/user/profile",className:"block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded",children:"My Reports"}),(0,t.jsx)("button",{className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded",children:"Settings"}),(0,t.jsx)("button",{className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded",children:"Logout"})]})]})]})}),(0,t.jsxs)("div",{className:"absolute top-14 left-0 right-0 bottom-0",children:[(0,t.jsx)(d.default,{pins:e.map(e=>({id:e.id,lat:e.lat,lng:e.lng,category:e.category,severity:e.severity,note:e.note})),onPinClick:t=>{j(e.find(e=>e.id===t.id)||null)}}),f&&(0,t.jsxs)("div",{className:"absolute bottom-20 left-4 right-4 bg-white rounded-lg border border-gray-200 shadow-lg overflow-hidden max-w-sm z-50",children:[(0,t.jsx)("div",{className:"w-full h-48 bg-gray-200 overflow-hidden",children:(0,t.jsx)("img",{src:f.imagePlaceholder,alt:f.category,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,t.jsxs)("h3",{className:"text-sm font-bold",children:["Case #",f.id]}),(0,t.jsx)("button",{onClick:()=>j(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:f.category}),(0,t.jsx)("p",{className:"text-sm text-gray-700 mb-3",children:f.note}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold",style:{backgroundColor:"High"===f.severity?"#fca5a5":"Medium"===f.severity?"#fcd34d":"#c6f6d5",color:"High"===f.severity?"#7f1d1d":"Medium"===f.severity?"#78350f":"#15803d"},children:f.severity}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["By ",f.reporter]})]})]})]})]}),(0,t.jsx)("div",{className:`fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-3 z-40 transition-all duration-300 ${v?"translate-y-full":"translate-y-0"}`,children:(0,t.jsx)("button",{onClick:()=>N(!0),className:"w-full py-3 px-6 rounded-2xl font-bold text-white shadow-lg transition-all active:scale-95",style:{backgroundColor:"var(--peep-primary)"},"aria-label":"Start a new pollution report",children:"Start Report"})}),(0,t.jsxs)("div",{className:`fixed bottom-0 left-0 right-0 top-0 bg-white border-t border-gray-200 rounded-t-2xl transition-all duration-300 z-[9999] max-h-screen overflow-y-auto ${v?"translate-y-0":"translate-y-full"}`,children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-white px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex-1 text-center",children:(0,t.jsxs)("div",{className:"text-xs font-bold text-gray-500 tracking-wide",children:["STEP ","location"===w?"1":"details"===w?"2":"impact"===w?"3":"✓"," OF 3"]})}),(0,t.jsx)("button",{onClick:()=>{"location"===w?N(!1):C("details"===w?"location":"impact"===w?"details":"impact")},className:"p-1 hover:bg-gray-100 rounded-lg","aria-label":"Collapse sheet",children:(0,t.jsx)(s.ChevronUp,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"px-4 pt-4",children:(0,t.jsx)("div",{className:"flex gap-2",children:["location","details","impact"].map((e,a)=>(0,t.jsx)("div",{className:"flex-1 h-1 rounded-full",style:{backgroundColor:"location"===e?"location"===w||"details"===w||"impact"===w?"var(--peep-primary)":"#ddd":"details"===e?"details"===w||"impact"===w?"var(--peep-primary)":"#ddd":"impact"===w?"var(--peep-primary)":"#ddd"}},e))})}),(0,t.jsx)("div",{className:"p-4 pb-8",children:"success"===w?(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto bg-green-100",children:(0,t.jsx)(r.Check,{className:"w-8 h-8 text-green-600"})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Report Submitted"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Case #",X]}),(0,t.jsx)("div",{className:"flex gap-2 pt-4",children:(0,t.jsxs)("button",{onClick:()=>{N(!1),C("location"),Z(""),U(""),D(""),G([])},className:"flex-1 py-3 px-4 rounded-lg font-semibold text-white transition-all active:scale-95",style:{backgroundColor:"var(--peep-primary)"},children:[(0,t.jsx)(i.Share2,{className:"w-4 h-4 inline mr-2"}),"Share"]})})]}):"location"===w?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold text-gray-900 mb-3",children:"Step 1: Choose Location"}),y&&(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-3 flex gap-2",children:[(0,t.jsx)(l.AlertCircle,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),(0,t.jsx)("p",{className:"text-sm text-yellow-800",children:y})]}),p&&(0,t.jsxs)("button",{onClick:()=>L({...p,label:"Current Location"}),className:"w-full p-3 border-2 rounded-lg text-left transition-all mb-3",style:{borderColor:P?.label==="Current Location"?"var(--peep-primary)":"#ddd",backgroundColor:P?.label==="Current Location"?"rgba(0, 128, 96, 0.05)":"transparent"},children:[(0,t.jsx)("p",{className:"font-medium text-sm text-gray-900",children:"Use My Current Location"}),(0,t.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Lat: ",p.lat.toFixed(4),", Lng: ",p.lng.toFixed(4)]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"Type location name or street",value:z,onChange:e=>M(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2",style:{outlineColor:"var(--peep-primary)"},"aria-label":"Search for location"}),R.length>0&&(0,t.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50",children:R.map(e=>(0,t.jsxs)("button",{onClick:()=>{L({lat:e.lat,lng:e.lng,label:e.name}),M(""),A([])},className:"w-full text-left px-3 py-2 hover:bg-gray-50 text-sm border-b border-gray-100 last:border-0",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.zone})]},`${e.lat}-${e.lng}`))})]})]}),P&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,t.jsx)("p",{className:"text-xs font-bold text-gray-600 uppercase tracking-wide",children:"Selected Location"}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 mt-1",children:P.label}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["Lat: ",P.lat.toFixed(4),", Lng: ",P.lng.toFixed(4)]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 text-center",children:"Location is required so authorities can find the spot."}),(0,t.jsx)("button",{onClick:()=>_&&C("details"),disabled:!_,className:"w-full py-3 px-4 rounded-lg font-semibold text-white transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--peep-primary)"},children:"Next: Add Details"})]}):"details"===w?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-bold text-gray-900",children:"Step 2: Title, Description & Category"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-900",children:"Clear Title *"}),(0,t.jsx)("input",{type:"text",placeholder:"e.g., Blackish runoff behind school gate",value:T,onChange:e=>Z(e.target.value),maxLength:100,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2","aria-label":"Report title"}),(0,t.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:[T.length,"/100 characters"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-900",children:"Description *"}),(0,t.jsx)("textarea",{placeholder:"Describe what you see in one line. Add detail about when you saw it, how often, who is affected.",value:E,onChange:e=>U(e.target.value),maxLength:500,rows:3,className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2","aria-label":"Report description"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-900",children:"Category *"}),(0,t.jsxs)("select",{value:B,onChange:e=>D(e.target.value),className:"w-full mt-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2","aria-label":"Problem category",children:[(0,t.jsx)("option",{value:"",children:"Select category..."}),(0,t.jsx)("option",{value:"Soil contamination",children:"Soil contamination"}),(0,t.jsx)("option",{value:"Stagnant water",children:"Stagnant water"}),(0,t.jsx)("option",{value:"Plastic / microplastics",children:"Plastic / microplastics"}),(0,t.jsx)("option",{value:"Damaged turf / turf runoff",children:"Damaged turf / turf runoff"}),(0,t.jsx)("option",{value:"Waste dumping",children:"Waste dumping"}),(0,t.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-900 block mb-3",children:"How bad is it? *"}),(0,t.jsx)("div",{className:"flex gap-2",children:["Low","Medium","High"].map(e=>(0,t.jsx)("button",{onClick:()=>O(e),className:"flex-1 py-2 px-3 rounded-lg font-semibold text-sm transition-all",style:{backgroundColor:F===e?"High"===e?"#ef4444":"Medium"===e?"#eab308":"#22c55e":"#f3f4f6",color:F===e?"white":"#666"},children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-900 block mb-2",children:"Attach Photo *"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("label",{className:"flex-1 px-3 py-2 border-2 border-dashed border-gray-300 rounded-lg text-center cursor-pointer hover:border-gray-400 transition-all",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>W(e.target.files?.[0]||null),className:"hidden","aria-label":"Upload photo from gallery"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:H?"✓ Photo selected":"Gallery"})]}),(0,t.jsxs)("label",{className:"flex-1 px-3 py-2 border-2 border-dashed border-gray-300 rounded-lg text-center cursor-pointer hover:border-gray-400 transition-all",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",capture:"environment",onChange:e=>W(e.target.files?.[0]||null),className:"hidden","aria-label":"Take photo with camera"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Camera"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{onClick:()=>C("location"),className:"flex-1 py-2 px-4 rounded-lg font-medium border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Back"}),(0,t.jsx)("button",{onClick:()=>ee&&C("impact"),disabled:!ee,className:"flex-1 py-2 px-4 rounded-lg font-medium text-white transition-all active:scale-95 disabled:opacity-50",style:{backgroundColor:"var(--peep-primary)"},children:"Next: Impact"})]})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-bold text-gray-900",children:"Step 3: Who's Affected?"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"How could this affect people?"}),(0,t.jsx)("div",{className:"space-y-2",children:[{id:"health",label:"Health (respiratory / skin)",hint:"Respiratory or skin irritation risk"},{id:"mosquito",label:"Mosquito / vector risk",hint:"Breeding ground for disease vectors"},{id:"safety",label:"Safety (slippery surfaces)",hint:"Risk of falls or accidents"},{id:"kids",label:"Play & sports risk for kids",hint:"Children playing nearby"},{id:"water",label:"Contaminated water source",hint:"Downstream water pollution"}].map(e=>(0,t.jsxs)("label",{className:"flex items-start gap-2 p-2 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"checkbox",checked:$.includes(e.id),onChange:()=>{var t;return t=e.id,void G(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"mt-1 w-4 h-4"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.label}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.hint})]})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-900 block mb-2",children:"Who is affected?"}),(0,t.jsxs)("select",{value:K,onChange:e=>V(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2",children:[(0,t.jsx)("option",{value:"",children:"Choose..."}),(0,t.jsx)("option",{value:"Children",children:"Children"}),(0,t.jsx)("option",{value:"Residents",children:"Residents"}),(0,t.jsx)("option",{value:"Athletes",children:"Athletes"}),(0,t.jsx)("option",{value:"Everyone",children:"Everyone"}),(0,t.jsx)("option",{value:"Not sure",children:"Not sure"})]})]}),(0,t.jsxs)("label",{className:"flex items-start gap-2 p-2 border border-gray-200 rounded-lg",children:[(0,t.jsx)("input",{type:"checkbox",checked:J,onChange:e=>Q(e.target.checked),className:"mt-1 w-4 h-4"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Share photo publicly"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"Make your photo visible to others viewing this report."})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsx)("button",{onClick:()=>C("details"),className:"flex-1 py-2 px-4 rounded-lg font-medium border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Back"}),(0,t.jsx)("button",{onClick:()=>{let t=Math.max(...e.map(e=>e.id),100)+1;Y(t),C("success"),console.log("[v0] Report submitted:",{caseId:t,title:T,location:P,category:B,severity:F,impacts:$,affectedPeople:K,sharePublicly:J})},className:"flex-1 py-3 px-4 rounded-lg font-semibold text-white transition-all active:scale-95",style:{backgroundColor:"var(--peep-primary)"},children:"Submit Report"})]})]})})]})]})}e.s(["default",()=>m])}]);